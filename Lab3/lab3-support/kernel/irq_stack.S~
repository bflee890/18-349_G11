	.file   "irq_stack.S"

FUNC(irq_stack)
	/*
	 * Branch immediately to main without altering the execution environment.
	 * This indirection is needed to guarantee that the program entry point is
	 * LOAD_ADDR (probably 0xa3000000) without placing strict
	 * requirements on the layout of kernel.c.  Bit first, provide main with the
	 * jump table address as one of its arguments.
	 */
	stmfd 	sp!,{r2, r3}
        mrs     r3,cpsr
        mov	r2, #0x40
        ORR 	r3,r3, r2
        msr     cpsr,r3
        ldr 	sp, =0xa1000000
        BIC 	r3,r3,r2	
        msr     cpsr,r3
        ldmfd 	sp!, {r2, r3} 
        mov     pc,lr
